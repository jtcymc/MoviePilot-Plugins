import{importShared as j}from"./__federation_fn_import-E6wRZccp.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{toDisplayString:a,createTextVNode:i,resolveComponent:n,withCtx:t,createVNode:e,openBlock:d,createBlock:y,createCommentVNode:I,createElementVNode:l,renderList:D,Fragment:z,createElementBlock:_}=await j("vue"),Y={class:"plugin-page"},Z={key:2},$={class:"text-h4 font-weight-bold"},tt={class:"text-h4 font-weight-bold text-success"},et={class:"text-h4 font-weight-bold text-warning"},ot={class:"text-h4 font-weight-bold text-info"},lt={key:0,class:"mt-4"},nt={key:1,class:"mt-4"},st={class:"d-flex align-center"},at={class:"font-weight-medium"},it={class:"text-caption text-secondary"},dt={class:"mt-4 text-subtitle-2"},{ref:b,onMounted:ct,computed:L}=await j("vue"),rt={__name:"Page",props:{model:{type:Object,default:()=>({title:"爬虫详情",stats:{total:0,enabled:0,disabled:0,tags:[]},recentItems:[]})},api:{type:Object,default:()=>{}}},emits:["action","switch","close"],setup(N,{emit:F}){const r=N,p=b(!0),f=b(null),w=b("running"),V=b(""),u=L(()=>r.model.stats),k=L(()=>r.model.recentItems),h=F;function O(s){return{movie:"mdi-movie",tv:"mdi-television-classic",download:"mdi-download",error:"mdi-alert-circle",success:"mdi-check-circle"}[s]||"mdi-information"}function S(s){return{movie:"blue",tv:"green",download:"purple",error:"red",success:"success"}[s]||"grey"}async function B(){p.value=!0,f.value=null;try{const s=await r.api.get("plugin/ExtendSpider/status");s&&(r.model.stats={total:s.total||0,enabled:s.enabled||0,disabled:s.disabled||0,tags:s.tags||[]},w.value=s.status||"running",V.value=new Date().toLocaleString()),r.model.recentItems=await r.api.get("plugin/ExtendSpider/history")||[]}catch(s){console.error("获取数据失败:",s),f.value=s.message||"获取数据失败"}finally{p.value=!1,h("action")}}function P(){h("switch")}function T(){h("close")}return ct(()=>{B()}),(s,o)=>{const M=n("v-card-title"),g=n("v-icon"),C=n("v-btn"),U=n("v-card-item"),q=n("v-alert"),A=n("v-skeleton-loader"),m=n("v-card-text"),v=n("v-card"),x=n("v-col"),G=n("v-row"),E=n("v-chip"),H=n("v-chip-group"),J=n("v-timeline-item"),K=n("v-timeline"),Q=n("v-spacer"),R=n("v-card-actions");return d(),_("div",Y,[e(v,null,{default:t(()=>[e(U,null,{append:t(()=>[e(C,{icon:"",color:"primary",variant:"text",onClick:T},{default:t(()=>[e(g,{left:""},{default:t(()=>o[0]||(o[0]=[i("mdi-close")])),_:1})]),_:1})]),default:t(()=>[e(M,null,{default:t(()=>[i(a(N.model.title),1)]),_:1})]),_:1}),e(m,null,{default:t(()=>[f.value?(d(),y(q,{key:0,type:"error",class:"mb-4"},{default:t(()=>[i(a(f.value),1)]),_:1})):I("",!0),p.value?(d(),y(A,{key:1,type:"card"})):(d(),_("div",Z,[e(G,null,{default:t(()=>[e(x,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(v,{variant:"outlined",class:"text-center"},{default:t(()=>[e(m,null,{default:t(()=>[l("div",$,a(u.value.total),1),o[1]||(o[1]=l("div",{class:"text-subtitle-1"},"爬虫总数",-1))]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(v,{variant:"outlined",class:"text-center"},{default:t(()=>[e(m,null,{default:t(()=>[l("div",tt,a(u.value.enabled),1),o[2]||(o[2]=l("div",{class:"text-subtitle-1"},"已启用",-1))]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(v,{variant:"outlined",class:"text-center"},{default:t(()=>[e(m,null,{default:t(()=>[l("div",et,a(u.value.disabled),1),o[3]||(o[3]=l("div",{class:"text-subtitle-1"},"已禁用",-1))]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(v,{variant:"outlined",class:"text-center"},{default:t(()=>[e(m,null,{default:t(()=>[l("div",ot,a(u.value.tags.length),1),o[4]||(o[4]=l("div",{class:"text-subtitle-1"},"标签数量",-1))]),_:1})]),_:1})]),_:1})]),_:1}),u.value.tags.length?(d(),_("div",lt,[o[5]||(o[5]=l("div",{class:"text-h6 mb-2"},"标签列表",-1)),e(H,null,{default:t(()=>[(d(!0),_(z,null,D(u.value.tags,c=>(d(),y(E,{key:c,color:"primary",variant:"outlined",class:"ma-1"},{default:t(()=>[i(a(c),1)]),_:2},1024))),128))]),_:1})])):I("",!0),k.value&&k.value.length?(d(),_("div",nt,[o[6]||(o[6]=l("div",{class:"text-h6 mb-2"},"最近记录",-1)),e(K,{density:"compact"},{default:t(()=>[(d(!0),_(z,null,D(k.value,(c,W)=>(d(),y(J,{key:W,"dot-color":S(c.type),size:"small"},{default:t(()=>[l("div",st,[e(g,{color:S(c.type),size:"small",class:"mr-2"},{default:t(()=>[i(a(O(c.type)),1)]),_:2},1032,["color"]),l("span",at,a(c.title),1)]),l("div",it,a(c.time),1)]),_:2},1032,["dot-color"]))),128))]),_:1})])):I("",!0),l("div",dt,[l("div",null,[o[7]||(o[7]=l("strong",null,"状态:",-1)),e(E,{size:"small",color:w.value==="running"?"success":"warning"},{default:t(()=>[i(a(w.value),1)]),_:1},8,["color"])]),l("div",null,[o[8]||(o[8]=l("strong",null,"最后更新:",-1)),i(" "+a(V.value),1)])])]))]),_:1}),e(R,null,{default:t(()=>[e(C,{color:"primary",onClick:B,loading:p.value},{default:t(()=>[e(g,{left:""},{default:t(()=>o[9]||(o[9]=[i("mdi-refresh")])),_:1}),o[10]||(o[10]=i(" 刷新数据 "))]),_:1},8,["loading"]),e(Q),e(C,{color:"primary",onClick:P},{default:t(()=>[e(g,{left:""},{default:t(()=>o[11]||(o[11]=[i("mdi-cog")])),_:1}),o[12]||(o[12]=i(" 配置 "))]),_:1})]),_:1})]),_:1})])}}},mt=X(rt,[["__scopeId","data-v-92b6f6e3"]]);export{mt as default};
