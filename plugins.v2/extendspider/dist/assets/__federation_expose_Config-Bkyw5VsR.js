import{importShared as G}from"./__federation_fn_import-E6wRZccp.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{createTextVNode:c,resolveComponent:s,withCtx:o,createVNode:l,toDisplayString:b,openBlock:y,createBlock:U,createCommentVNode:ie,createElementVNode:C,renderList:D,Fragment:F,createElementBlock:N,withKeys:de,withModifiers:ce}=await G("vue"),pe={class:"plugin-config"},ue={class:"d-flex align-center"},_e={class:"d-flex justify-end mt-4"},{ref:x,reactive:S,onMounted:fe,computed:xe}=await G("vue"),me={__name:"Config",props:{initialConfig:{type:Object,default:()=>({})},api:{default:()=>{}}},emits:["save","close","switch"],setup(P,{emit:M}){const u=P,I=x(null),V=x(!0),i=x(""),B=x(!1),m={Bt1louSpider:{spider_name:"Bt1louSpider",spider_enable:!0,spider_proxy:!1,pass_cloud_flare:!0,proxy_type:"playwright",spider_desc:"BT之家1LOU站-回归初心，追求极简",spider_tags:[]},BtBtlSpider:{spider_name:"BtBtlSpider",spider_enable:!0,spider_proxy:!1,proxy_type:"playwright",spider_desc:"BT影视_4k高清电影BT下载_蓝光迅雷电影下载_最新电视剧下载"},BtBuLuoSpider:{spider_name:"BtBuLuoSpider",spider_enable:!0,spider_proxy:!1,proxy_type:"playwright",spider_desc:"BT部落天堂 - 注重体验与质量的影视资源下载网站"},BtdxSpider:{spider_name:"BtdxSpider",spider_enable:!0,spider_proxy:!1,proxy_type:"playwright",spider_desc:"比特大雄_BT电影天堂_最新720P、1080P高清电影BT种子免注册下载网站"},BtttSpider:{spider_name:"BtttSpider",spider_enable:!0,spider_proxy:!1,proxy_type:"playwright",spider_desc:"BT天堂 - 2025最新高清电影1080P|2160P|4K资源免费下载"},Dytt8899Spider:{spider_name:"Dytt8899Spider",spider_enable:!0,spider_proxy:!1,proxy_type:"playwright",spider_desc:"电影天堂_电影下载_高清首发"},Bt0lSpider:{spider_name:"Bt0lSpider",spider_enable:!0,spider_proxy:!1,proxy_type:"playwright",spider_desc:"不太灵-影视管理系统"},CiLiXiongSpider:{spider_name:"CiLiXiongSpider",spider_enable:!0,spider_proxy:!1,pass_cloud_flare:!0,proxy_type:"playwright",spider_desc:"磁力熊，支持完结影视"},GyingKSpider:{spider_name:"GyingKSpider",spider_enable:!0,spider_proxy:!1,pass_cloud_flare:!1,proxy_type:"playwright",spider_desc:"观影 GYING",spider_username:"",spider_password:""}},r=S({enabled:!1,cron:"0 0 */24 * *",onlyonce:!1,spider_config:{...m},tags:[]});x(Object.values(r.spider_config));const g=S({}),h=S({});x("");const _=S({});fe(()=>{u.initialConfig&&(Object.assign(r,u.initialConfig),u.initialConfig.spider_config&&(r.spider_config={...m,...u.initialConfig.spider_config})),Object.keys(r.spider_config).forEach(t=>{g[t]=JSON.stringify(r.spider_config[t],null,2),_[t]=""})});const k=M;async function R(t){try{const e=await u.api.post("plugin/ExtendSpider/toggle_spider",{spider_name:t});e.success?i.value=null:i.value=e.message}catch(e){i.value=e.message||"操作失败"}}function X(t){try{const e=JSON.parse(g[t]);if(!e.spider_name||!e.spider_desc)throw new Error("配置缺少必要字段");r.spider_config[t]=e,h[t]=""}catch{h[t]="JSON格式错误或缺少必要字段"}}async function q(t){try{const e=await u.api.post("plugin/ExtendSpider/reset_config",{spider_name:t});e.success?(r.spider_config[t]={...m[t]},g[t]=JSON.stringify(m[t],null,2),i.value=null):i.value=e.message}catch(e){i.value=e.message||"重置失败"}}async function A(){try{const t=await u.api.post("plugin/ExtendSpider/reset_all_config");t.success?(r.spider_config={...m},Object.keys(m).forEach(e=>{g[e]=JSON.stringify(m[e],null,2)}),i.value=null):i.value=t.message}catch(t){i.value=t.message||"重置失败"}}async function E(){if(!V.value){i.value="请修正表单错误";return}B.value=!0,i.value=null;try{k("save",{...r})}catch(t){console.error("保存配置失败:",t),i.value=t.message||"保存配置失败"}finally{B.value=!1}}function Y(){k("switch")}function z(){k("close")}async function O(t){if(_[t])try{await u.api.post("plugin/ExtendSpider/add_tag",{spider_name:t,tag:_[t]}),r.spider_config[t].spider_tags||(r.spider_config[t].spider_tags=[]),r.spider_config[t].spider_tags.push(_[t]),_[t]=""}catch(e){console.error("添加标签失败:",e),i.value=e.message||"添加标签失败"}}async function H(t,e){try{await u.api.post("plugin/ExtendSpider/remove_tag",{spider_name:t,tag:e});const f=r.spider_config[t].spider_tags.indexOf(e);f>-1&&r.spider_config[t].spider_tags.splice(f,1)}catch(f){console.error("删除标签失败:",f),i.value=f.message||"删除标签失败"}}return(t,e)=>{const f=s("v-card-title"),T=s("v-icon"),v=s("v-btn"),Q=s("v-card-item"),W=s("v-alert"),w=s("v-switch"),J=s("v-text-field"),j=s("v-card-text"),K=s("v-card"),Z=s("v-expansion-panel-title"),p=s("v-col"),ee=s("v-select"),L=s("v-textarea"),$=s("v-row"),le=s("v-chip"),te=s("v-chip-group"),oe=s("v-expansion-panel-text"),ne=s("v-expansion-panel"),ae=s("v-expansion-panels"),se=s("v-form");return y(),N("div",pe,[l(K,null,{default:o(()=>[l(Q,null,{append:o(()=>[l(v,{icon:"",color:"primary",variant:"text",onClick:z},{default:o(()=>[l(T,{left:""},{default:o(()=>e[4]||(e[4]=[c("mdi-close")])),_:1})]),_:1})]),default:o(()=>[l(f,null,{default:o(()=>e[3]||(e[3]=[c("爬虫配置")])),_:1})]),_:1}),l(j,{class:"overflow-y-auto"},{default:o(()=>[i.value?(y(),U(W,{key:0,type:"error",class:"mb-4"},{default:o(()=>[c(b(i.value),1)]),_:1})):ie("",!0),l(se,{ref_key:"form",ref:I,modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=a=>V.value=a),onSubmit:ce(E,["prevent"])},{default:o(()=>[l(K,{class:"mb-4"},{default:o(()=>[l(f,null,{default:o(()=>e[5]||(e[5]=[c("基础设置")])),_:1}),l(j,null,{default:o(()=>[l(w,{modelValue:r.enabled,"onUpdate:modelValue":e[0]||(e[0]=a=>r.enabled=a),label:"启用插件",color:"primary","hide-details":"",class:"mb-4"},null,8,["modelValue"]),l(J,{modelValue:r.cron,"onUpdate:modelValue":e[1]||(e[1]=a=>r.cron=a),label:"更新周期",hint:"Cron表达式，例如：0 */6 * * *","persistent-hint":"",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1}),e[12]||(e[12]=C("div",{class:"text-subtitle-1 font-weight-bold mt-4 mb-2"},"爬虫配置",-1)),l(ae,{variant:"accordion"},{default:o(()=>[(y(!0),N(F,null,D(r.spider_config,(a,d)=>(y(),U(ne,{key:d},{default:o(()=>[l(Z,null,{default:o(()=>[C("div",ue,[l(T,{color:a.spider_enable?"success":"error",class:"mr-2"},{default:o(()=>[c(b(a.spider_enable?"mdi-check-circle":"mdi-close-circle"),1)]),_:2},1032,["color"]),c(" "+b(a.spider_name)+" - "+b(a.spider_desc),1)])]),_:2},1024),l(oe,null,{default:o(()=>[l($,null,{default:o(()=>[l(p,{cols:"12",md:"6"},{default:o(()=>[l(w,{modelValue:a.spider_enable,"onUpdate:modelValue":n=>a.spider_enable=n,label:"启用爬虫",color:"primary",inset:"",onChange:n=>R(d)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),l(p,{cols:"12",md:"6"},{default:o(()=>[l(w,{modelValue:a.spider_proxy,"onUpdate:modelValue":n=>a.spider_proxy=n,label:"使用代理",color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{cols:"12",md:"6"},{default:o(()=>[l(w,{modelValue:a.pass_cloud_flare,"onUpdate:modelValue":n=>a.pass_cloud_flare=n,label:"绕过CloudFlare",color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{cols:"12",md:"6"},{default:o(()=>[l(ee,{modelValue:a.proxy_type,"onUpdate:modelValue":n=>a.proxy_type=n,label:"代理类型",items:["playwright","requests"],variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{cols:"12"},{default:o(()=>[l(L,{modelValue:a.spider_desc,"onUpdate:modelValue":n=>a.spider_desc=n,label:"爬虫描述",variant:"outlined",rows:"2",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{cols:"12"},{default:o(()=>[e[7]||(e[7]=C("div",{class:"text-subtitle-1 mb-2"},"标签管理",-1)),l($,null,{default:o(()=>[l(p,{cols:"12",sm:"8"},{default:o(()=>[l(J,{modelValue:_[d],"onUpdate:modelValue":n=>_[d]=n,label:"添加新标签",variant:"outlined",density:"comfortable",onKeyup:de(n=>O(d),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1024),l(p,{cols:"12",sm:"4",class:"d-flex align-center"},{default:o(()=>[l(v,{color:"primary",block:"",onClick:n=>O(d),disabled:!_[d]},{default:o(()=>e[6]||(e[6]=[c(" 添加标签 ")])),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024),l(te,{class:"mt-4"},{default:o(()=>[(y(!0),N(F,null,D(a.spider_tags||[],n=>(y(),U(le,{key:n,color:"primary",variant:"outlined",closable:"","onClick:close":ge=>H(d,n),class:"ma-1"},{default:o(()=>[c(b(n),1)]),_:2},1032,["onClick:close"]))),128))]),_:2},1024)]),_:2},1024),l(p,{cols:"12"},{default:o(()=>[l(L,{modelValue:g[d],"onUpdate:modelValue":[n=>g[d]=n,n=>X(d)],label:"爬虫配置（JSON格式）",variant:"outlined",rows:"6","error-messages":h[d]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),_:2},1024),l(p,{cols:"12",class:"d-flex justify-end"},{default:o(()=>[l(v,{color:"warning",variant:"outlined",class:"mr-2",onClick:n=>q(d)},{default:o(()=>e[8]||(e[8]=[c(" 重置配置 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),C("div",_e,[l(v,{color:"warning",variant:"outlined",class:"mr-2",onClick:A},{default:o(()=>e[9]||(e[9]=[c(" 重置所有配置 ")])),_:1}),l(v,{color:"info",variant:"outlined",class:"mr-2",onClick:Y},{default:o(()=>e[10]||(e[10]=[c(" 切换到详情 ")])),_:1}),l(v,{color:"primary",disabled:!V.value,onClick:E,loading:B.value},{default:o(()=>e[11]||(e[11]=[c(" 保存配置 ")])),_:1},8,["disabled","loading"])])]),_:1},8,["modelValue"])]),_:1})]),_:1})])}}},be=re(me,[["__scopeId","data-v-f8b7055e"]]);export{be as default};
